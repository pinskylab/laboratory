---
title: "ddRADSeq Library Prep"
output: 
  github_document:
    toc: TRUE
    toc_depth: 3
always_allow_html: yes
params:
  num_dna_samples: 96
  num_pools: 2
  num_seq_lib: 1
  num_dna_adapters: 48
  database: FALSE
---
<!-- http://www.nagraj.net/notes/multiple-rmarkdown-reports/ will read in a bunch of data files, but not rmds-->
<!-- https://stackoverflow.com/questions/25824795/how-to-combine-two-rmarkdown-rmd-files-into-a-single-output parents and children -->
<!-- https://stackoverflow.com/questions/49475303/rmarkdown-child-documents-do-not-detect-their-params -->
## *Amphiprion clarkii* Sample provenance
Some of our methods have changed over time.  Here is a very simplified breakdown of which protocols were used with which samples.
```{r echo=FALSE}
kableExtra::kable_styling(
knitr::kable(
readr::read_csv("field season, extraction method, ligation setup, baits
          2012, Qiagen DNeasy 96, no robot, no baits
          2013, Qiagen DNeasy 96, no robot, no baits
          2014, Qiagen DNeasy 96, no robot, no baits
          2015, Qiagen DNeasy 96, no robot and robot, no baits
          2016, Ali, robot, baits
          2017, Ali, robot, baits
          2018, Ali, robot, baits")
)
)


```

**WARNING: These protocols are abridged versions of the manufacturers recommended protocols.  Use of these protocols assumes familiarity with manufacutrers instructions.  Please read manufacturers instructions if this is your first time (or first time in a while) performing these procedures.**

## 1. DNA Extraction
```{r child="../protocols/dna_extraction_ali.Rmd"}

```

## 2. Quantify
### 1/2 hour per plate or qubit run
```{r child="../protocols/quant_dna.Rmd"}

```

## 3. Digest
### 3 hours, add ~1/2 hour for every additional plate.
```{r child="../protocols/digest_dna.Rmd"}
```

## 4. Clean 
#### 1 hour per plate
```{r include=FALSE}
remove(params)
params <- list(
  num_dna_samples = 96,
  num_pools = 2,
  num_seq_lib = 1,
  num_dna_adapters = 48,
  database = FALSE,
  sample_vol_ul= 30,
  ampure_vol_ul = 45
)
```
```{r child="../protocols/ampure.Rmd"}
```

## 5. Quantify
### 1/2 hour for each plate or qubit run
```{r child="../protocols/quant_dna.Rmd"}

```

## Anneal?
### If adapters, oligos, or primers need to be rehydrated, it should be done the day before they are needed.  This is a good place to check supplies and make sure you have plenty of working stock of the oligos.
```{r include=FALSE}
remove(params)
params <- list(
  num_dna_samples = 96,
  num_pools = 2,
  num_seq_lib = 1,
  num_dna_adapters = 48,
  database = FALSE,
  sample_vol_ul= 30,
  ampure_vol_ul = 45,
  initial_conc_uM = 100,
  p1_adapter_name = "p1_stock_adapter_ul",
  p2_adapter_name = "p2_stock_adapter_ul", 
  working_conc_uM = 10,
  final_vol_ul = 100,
  nmol_oligo = 9,
  adpater_stock = "p1_stock_adapter_ul")
```

```{r child="../protocols/anneal.Rmd"}

```

```{r child="../protocols/adapter_working_stock.Rmd"}

```
  

## 6. Robot
### 1/2 hour per plate plus driving to Princeton
```{r child="../protocols/robot.Rmd"}

```


## 7. Ligate DNA
### 4 hours plus 1/2 hour per plate
```{r child="../protocols/ligation_ddradseq.Rmd"}

```

## 8. Pool
### 1 hour
- Break up pools into 4 vials each pool
```{r child="../protocols/pool.Rmd"}

```


## 9. Clean 1
```{r child="../protocols/ampure.Rmd"}

```
 
## 10. Clean 2
- Elute into 30ul of buffer
```{r child="../protocols/ampure.Rmd"}

```

## 11. Size Select
```{r child="../protocols/pippin.Rmd"}

```

## 12. PCR
```{r child="../protocols/lib-amp_eecseq.Rmd"}

```

## 13. Baits
```{r child="../protocols/baits.Rmd"}

```

## 14. Sequencing Prep

```{r include=FALSE}
params <- list(
  date = "2018-09-13",
  facility = PrincetonLSI,
  first_baits = B010,
  frag_length = 430,
  last_baits = B012,
  library_type = ddRADSeq,
  num_lanes = 2,
  pe_or_se = se,
  platform = hiseq,
  seq = SEQ28, 
  database = FALSE)
```

```{r child="seq-prep_ddradseq.Rmd"}

```



