---
title: "Seth's test samples"
output:
  html_notebook:
    code_folding: hide
    df_print: paged
params:
  first: fish_1_worm_2
  last: seth_5
  num_samples: 5
---
```{r setup, echo=FALSE, message=FALSE}
library(knitr)
library(kableExtra)
library(tidyverse)
```

## This is a test run of the Ali extraction method on Seth's worm samples.
```{r}
(params)
```


**Samples were lysed and DNA extracted following the protocol in [Ali et al. 2016](https://doi.org/10.1534/genetics.115.183665).**

## Special notes:  
 The 26% salt solution is 4.45 Molar.

_________  

# Supplies needed
```{r, echo=FALSE}
(extr <- tibble(
  liftons_ul = (80*params$num_samples)*1.1,
  enzyme_ul = (40*params$num_samples)*1.1,
  tips_100 = 8*params$num_samples,
  plates = 2*ceiling(params$num_samples/96),
  prot_K_ul = (40*params$num_samples)*1.1,
  seals = plates,
  hybr_buffer = (45*params$num_samples)*1.1,
  ampure_ul = (15*params$num_samples)*1.1,
  tips_300 = 6*params$num_samples,
  ethanol_ul = 3*(150*params$num_samples)*1.1,
  low_te_ul = (45*params$num_samples)*1.1) %>% 
   gather(item, quantity)) %>% 
  mutate(ml = quantity/1000, 
         ml = ifelse(ml < 1, NA, ml))
```
```{r}
extr_wide = spread(extr, key = item, value = quantity)
```

# Extraction Methods


## 2019-09-05
**Prepare a solution of Lifton's Buffer**
```{r liftons, echo=FALSE}
liftons <- readr::read_csv("ingredient, initial_conc, initial_vol_mL, final_conc, final_vol_mL
mM_EDTA, 500, NA, 100, NA
mM_Tris-HCl_pH7.5, 1000, NA, 25, NA
perc_SDS, 20, NA, 1, NA
pH2O, NA, NA, NA, NA
") %>% 
  mutate(final_vol_mL = (extr_wide$liftons_ul/1000), 
         initial_vol_mL = final_conc* final_vol_mL/initial_conc,
         initial_vol_mL = ifelse(ingredient == "pH2O",final_vol_mL - sum(initial_vol_mL, na.rm = T), initial_vol_mL))
 
         
kable(liftons) %>%
  kable_styling("bordered") %>%
  add_header_above(c("Lifton's Buffer" = 5))
```

**Prepare Lifton's buffer with proteinase K**
```{r enzyme, echo=FALSE}
enzyme <- readr::read_csv("ingredient, initial_conc, initial_vol_uL, final_conc, final_vol_uL
mM_DTT, 1000, NA, 75, NA
mg/ml_ProteinaseK, 20, NA, 4.2, NA
Liftons, NA, NA, NA, NA
") %>% 
  mutate(final_vol_uL = (extr_wide$enzyme_ul), 
         initial_vol_uL = final_conc*as.numeric(final_vol_uL)/initial_conc, 
         initial_vol_uL = ifelse(ingredient == "Liftons",as.numeric(final_vol_uL) - sum(initial_vol_uL, na.rm = T), initial_vol_uL))

kable(enzyme) %>%
  kable_styling("bordered") %>%
  add_header_above(c("Lifton's with Proteinase K" = 5))
```
**Prepare hybridization solution**
```{r hybrid, echo=FALSE}
hybrid <- readr::read_csv("ingredient, initial_conc, initial_vol, final_conc, final_vol_ul
M_NaCl, 4.45, NA, 2.5, NA
perc_PEG_8000, 50, NA, 20, NA
mM_DTT, 1000, NA, 25, NA
pH2O, NA, NA, NA, NA
") %>% 

  mutate(final_vol_ul = extr_wide$hybr_buffer,
         initial_vol = final_conc*final_vol_ul/initial_conc, 
         initial_vol = ifelse(ingredient == "pH2O",final_vol_ul - sum(initial_vol, na.rm = T), initial_vol))

kable(hybrid) %>%
  kable_styling("bordered") %>%
  add_header_above(c("Hybridization Buffer" = 5))
```
Turn on the incubator

**Load samples for lysis**  
1. Add 80uL Lifton's buffer to each tube.  
2. Add tissue measuring 2-25mm^2 to each well.  
3. Add 40uL enzyme solution to each tube, pipet up and down to mix.  
4. Seal tube with parafilm and incubate at 55C overnight.  
  

## 2019-09-06
**Extract DNA from lysate**  
1. To a new plate add 45uL hybridization buffer to each well.  
2. Add 15uL Agencourt Ampure beads.  
3. Add 45uL of the lysate and pipet up and down to mix.  
4. Incubate at room temperature for 5 minutes, then place on magnet and allow the wells to clear.  
5.  Remove supernatant.  
6. Remove from the magnet and use 150uL freshly prepared 80% EtOH to resuspend the beads.  
7. Wash with ethanol again  
8. wash with ethanol a 3rd time.  
9. Allow beads to air dry on the magnet   
10. Add 45uL low TE to elute DNA from the beads  

**Prepare low TE solution**
```{r low_TE, echo=FALSE}
low_te <- readr::read_csv("ingredient, initial_conc, initial_vol, final_conc, final_vol
mM_Tris-HCl_pH7.5, 1000, NA, 10, NA
mM_EDTA, 500, NA, 0.1, NA
pH2O, NA, NA, NA, NA") %>% 
  mutate(final_vol = extr_wide$low_te_ul, 
         initial_vol= final_conc*final_vol/initial_conc, 
         initial_vol = ifelse(ingredient == "pH2O",final_vol - sum(initial_vol, na.rm = T), initial_vol))

kable(low_te) %>%
  kable_styling() %>%
  add_header_above(c("Low TE buffer" = 5))
```

*Check out a generic DNA cleaner recipe from Bridgett vonHoldt to replace the very expensive version we use here.*

